Public Class Form1
    Dim grid(30, 30) As PictureBox
    Dim xSpeed As Integer
    Dim ySpeed As Integer
    Dim direction As String
    Private Sub Form1_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Me.KeyPress
        Select Case e.KeyChar
            Case "a"
                xSpeed = -30
                ySpeed = 0
                direction = "left"
            Case "s"
                xSpeed = 0
                ySpeed = 30
                direction = "down"
            Case "d"
                xSpeed = 30
                ySpeed = 0
                direction = "right"
            Case "w"
                xSpeed = 0
                ySpeed = -30
                direction = "up"
        End Select
    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        makeGrid()
    End Sub

    Sub makeGrid()
        For x = 0 To 25
            For y = 0 To 28
                grid(x, y) = New PictureBox
                With grid(x, y)
                    .Height = 5
                    .Width = 5
                    .Left = x * 30 + 10
                    .Top = y * 30 + 10
                    .BackColor = Color.Red
                End With
                Me.Controls.Add(grid(x, y))
            Next
        Next
    End Sub

    Private Sub pacManMover_Tick(sender As Object, e As EventArgs) Handles pacManMover.Tick
        pacMan.Left += xSpeed
        pacMan.Top += ySpeed
        collision()
    End Sub

    Sub collision()
        For Each thisLabel In Me.Controls
            If thisLabel.GetType.Equals(Label1.GetType) And pacMan.Bounds.IntersectsWith(thisLabel.bounds) Then
                Select Case direction
                    Case "left"
                        xSpeed = 0
                        pacMan.Left += 30
                    Case "right"
                        xSpeed = 0
                        pacMan.Left -= 30
                    Case "up"
                        ySpeed = 0
                        pacMan.Top += 30
                    Case "down"
                        ySpeed = 0
                        pacMan.Top -= 30
                End Select
            End If
        Next
    End Sub
End Class
