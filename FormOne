Public Class Form1
    Dim animationCounter As Integer = 0
    Dim direction As String = "down"
    Dim grid(26, 29) As PictureBox
    Dim xSpeed As Integer = 30
    Dim ySpeed As Integer = 0

    Dim walls(100) As Label
    Dim wallIndex As Integer = -1

    Private Sub btnStart_Click(sender As Object, e As EventArgs) Handles btnStart.Click
        btnStart.Hide()
        TManimation.Start()
        makeDots()
        pacManMover.Start()
        Me.Focus()
    End Sub
    Private Sub TManimation_Tick(sender As Object, e As EventArgs) Handles TManimation.Tick
        Select Case animationCounter
            Case 1
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftOne.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightOne.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upOne.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downOne.png")
                End Select
               

            Case 2
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftTwo.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightTwo.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upTwo.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downTwo.png")
                End Select

            Case 3
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftOne.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightOne.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upOne.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downOne.png")
                End Select

            Case 4
                pacMan.Image = Image.FromFile(CurDir() & "\pmone.png")
                animationCounter = 0
        End Select
        animationCounter += 1
    End Sub
    Private Sub Form1_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Me.KeyPress
        Select Case e.KeyChar
            Case "a"
                xSpeed = -30
                ySpeed = 0
                direction = "left"
            Case "s"
                xSpeed = 0
                ySpeed = 30
                direction = "down"
            Case "d"
                xSpeed = 30
                ySpeed = 0
                direction = "right"
            Case "w"
                xSpeed = 0
                ySpeed = -30
                direction = "up"
        End Select
    End Sub

    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        makeDots()
        makeAllTheWalls()
    End Sub
    Sub makeDots()
        For x = 0 To 25
            For y = 0 To 28
                grid(x, y) = New PictureBox
                With grid(x, y)
                    .Height = 5
                    .Width = 5
                    .Left = x * 30 + 30
                    .Top = y * 30 + 30
                    .Image = pacManDot.Image
                    .SizeMode = PictureBoxSizeMode.StretchImage
                End With
                Me.Controls.Add(grid(x, y))
                grid(x, y).BringToFront()
            Next
        Next
    End Sub
    Private Sub pacManMover_Tick(sender As Object, e As EventArgs) Handles pacManMover.Tick
        pacMan.Left += xSpeed
        pacMan.Top += ySpeed
    End Sub

    'This sub will tak 4 inputs and draw
    'rectangles and squares on the form.
    Sub makeWall(w As Integer, h As Integer, x As Integer, y As Integer, col As Color)
        wallIndex += 1
        walls(wallIndex) = New Label
        With walls(wallIndex)
            .Height = h
            .Width = w
            .Top = y
            .Left = x
            .BackColor = col
            .AutoSize = False
            .Text = ""
        End With
        Me.Controls.Add(walls(wallIndex))
        walls(wallIndex).BringToFront()
    End Sub
    Sub makeAllTheWalls()
        makeWall(840, 15, 0, 0, Color.Blue)
        makeWall(836, 11, 2, 2, Color.Black)

        makeWall(15, 270, 0, 0, Color.Blue)
        makeWall(11, 266, 2, 2, Color.Black)

        makeWall(120, 90, 45, 45, Color.Blue)
        makeWall(116, 86, 47, 47, Color.Black)

        makeWall(150, 90, 195, 45, Color.Blue)
        makeWall(146, 86, 197, 47, Color.Black)

        makeWall(30, 115, 375, 15, Color.Blue)
        makeWall(26, 111, 377, 13, Color.Black)

    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        makeAllTheWalls()
        Button1.Hide()
        Me.Focus()
    End Sub
End Class
