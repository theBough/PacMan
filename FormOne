Public Class Form1
    Dim grid(30, 30) As PictureBox
    Dim xSpeed As Integer
    Dim ySpeed As Integer
    Dim direction As String
    Dim animationCounter As Integer = 0

    Dim walls(100) As Label
    Dim wallIndex As Integer = -1
    Private Sub Form1_KeyPress(sender As Object, e As KeyPressEventArgs) Handles Me.KeyPress
        Select Case e.KeyChar
            Case "a"
                xSpeed = -30
                ySpeed = 0
                direction = "left"
            Case "s"
                xSpeed = 0
                ySpeed = 30
                direction = "down"
            Case "d"
                xSpeed = 30
                ySpeed = 0
                direction = "right"
            Case "w"
                xSpeed = 0
                ySpeed = -30
                direction = "up"
        End Select
    End Sub
    Private Sub Form1_Load(sender As Object, e As EventArgs) Handles MyBase.Load
        makeGrid()
        makeAllTheWalls()
    End Sub
    Sub makeGrid()
        For x = 0 To 25
            For y = 0 To 28
                grid(x, y) = New PictureBox
                With grid(x, y)
                    .Height = 5
                    .Width = 5
                    .Left = x * 30 + 10
                    .Top = y * 30 + 10
                    .BackColor = Color.Red
                End With
                Me.Controls.Add(grid(x, y))
            Next
        Next
    End Sub
    Private Sub pacManMover_Tick(sender As Object, e As EventArgs) Handles pacManMover.Tick
        pacMan.Left += xSpeed
        pacMan.Top += ySpeed
        collision()
    End Sub
    Sub collision()
        For i = 0 To wallIndex
            If pacMan.Bounds.IntersectsWith(walls(i).Bounds) Then
                Select Case direction
                    Case "left"
                        xSpeed = 0
                        pacMan.Left += 30
                    Case "right"
                        xSpeed = 0
                        pacMan.Left -= 30
                    Case "up"
                        ySpeed = 0
                        pacMan.Top += 30
                    Case "down"
                        ySpeed = 0
                        pacMan.Top -= 30
                End Select
            End If
        Next
        For x = 0 To 25
            For y = 0 To 28
                If pacMan.Bounds.IntersectsWith(grid(x, y).Bounds) Then
                    grid(x, y).Hide()
                End If
            Next
        Next
    End Sub

    Private Sub tmAnimation_Tick(sender As Object, e As EventArgs) Handles tmAnimation.Tick
        Select Case animationCounter
            Case 1
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftOne.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightOne.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upOne.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downOne.png")
                End Select
            Case 2
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftTwo.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightTwo.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upTwo.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downTwo.png")
                End Select
            Case 3
                Select Case direction
                    Case "left"
                        pacMan.Image = Image.FromFile(CurDir() & "\leftOne.png")
                    Case "right"
                        pacMan.Image = Image.FromFile(CurDir() & "\rightOne.png")
                    Case "up"
                        pacMan.Image = Image.FromFile(CurDir() & "\upOne.png")
                    Case "down"
                        pacMan.Image = Image.FromFile(CurDir() & "\downOne.png")
                End Select
            Case 4
                pacMan.Image = Image.FromFile(CurDir() & "\pmone.png")
                animationCounter = 0
        End Select
        animationCounter += 1

    End Sub
    Sub makeWall(w As Integer, h As Integer, x As Integer, y As Integer, col As Color)
        wallIndex += 1
        walls(wallIndex) = New Label
        With walls(wallIndex)
            .Height = h
            .Width = w
            .Top = y
            .Left = x
            .BackColor = col
            .AutoSize = False
            .Text = ""
        End With
        Me.Controls.Add(walls(wallIndex))
        walls(wallIndex).BringToFront()
    End Sub
    Sub makeAllTheWalls()
        'roof
        makeWall(840, 15, 5, 5, Color.Blue)
        makeWall(836, 11, 7, 7, Color.Black)
        'left wall
        makeWall(15, 300, 5, 5, Color.Blue)
        makeWall(11, 296, 7, 7, Color.Black)
        'Row 1 pos 1
        makeWall(90, 60, 60, 60, Color.Blue)
        makeWall(86, 56, 62, 62, Color.Black)
        'Row 1 pos 2
        makeWall(120, 60, 180, 60, Color.Blue)
        makeWall(116, 56, 182, 62, Color.Black)
        'Row 1 pos 3
        makeWall(30, 120, 330, 5, Color.Blue)
        makeWall(26, 116, 332, 7, Color.Black)
        'Clean up the over laps
        makeWall(35, 11, 330, 7, Color.Black)
        'Row 1 pos 4
        makeWall(120, 60, 390, 60, Color.Blue)
        makeWall(116, 56, 392, 62, Color.Black)
        'Row 1 pos 5
        makeWall(90, 60, 540, 60, Color.Blue)
        makeWall(86, 56, 542, 62, Color.Black)

    End Sub

End Class
